<!doctype html>
<html lang="ar">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>خريطة سبر</title>
  <link rel="stylesheet" href="https://unpkg.com/leaflet/dist/leaflet.css" />
  <style>
    html, body, #map { height:100%; margin:0; }
    .leaflet-control-layers-expanded { direction:ltr; }
  </style>
</head>
<body>
  <div id="map"></div>
  <script src="https://unpkg.com/leaflet/dist/leaflet.js"></script>
  <script>
    // 1) أنشئ الخريطة وخليها تفتح على العالم كله (ثم زوّم على منطقتك)
    const map = L.map('map', { zoomControl:true });
    map.fitWorld(); // يضمن أن OSM تظهر حتى لو المركز غير مضبوط

    // 2) OSM كطبقة أساس (لازم تشوف خريطة الآن)
    const osm = L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
      attribution: '© OpenStreetMap'
    }).addTo(map);

    // 3) طبقاتك حسب ترتيبك:
    //   - 12 و 13: tiles/12/{x}/{y}.png و tiles/13/{x}/{y}.png
    //   - 14–18:   tiles/{z}/{x}/{y}.png
    // ملاحظة: جرّب tms:false إذا ما ظهرت (على حسب إخراج QGIS)
    const Z12 = L.tileLayer('tiles/12/{x}/{y}.png', {
      minZoom:12, maxZoom:12, tms:true
    });
    const Z13 = L.tileLayer('tiles/13/{x}/{y}.png', {
      minZoom:13, maxZoom:13, tms:true
    });
    const Z14_18 = L.tileLayer('tiles/{z}/{x}/{y}.png', {
      minZoom:14, maxZoom:18, tms:true
    });

    // 4) راقب أخطاء تحميل البلاطات لتعرف المسار الغلط (يظهر بالـConsole)
    function watch(layer, name){
      layer.on('tileerror', e => {
        console.warn(`[tileerror:${name}]`, e.tile.src);
      });
    }
    watch(Z12,'Z12'); watch(Z13,'Z13'); watch(Z14_18,'Z14-18');

    // 5) أضف الطبقات (ما راح تظهر إلا عند مستوى الزووم المطابق)
    Z12.addTo(map);
    Z13.addTo(map);
    Z14_18.addTo(map);

    // 6) كنترول طبقات للتبديل
    L.control.layers(
      { 'OSM (أساس)': osm },
      { 'Z12': Z12, 'Z13': Z13, 'Z14–18': Z14_18 },
      { collapsed:false }
    ).addTo(map);

    // 7) لو تعرف إحداثيات مشروعك، زوّم عليها:
    // map.setView([21.6, 39.1], 12);
  </script>
</body>
</html>
